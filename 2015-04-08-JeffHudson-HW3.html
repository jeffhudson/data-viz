<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Jeff's Magic Graph</title>
    <link rel="stylesheet" type="text/css" href="d3-cookbook/css/styles.css"/>
    <script type="text/javascript" src="d3-cookbook/lib/d3.js"></script>
</head>

<body>

<div class="control-group">
    <button onclick="setup()">
<<<<<<< HEAD
        generate new data!
    </button>
=======
        setup
    </button>
    <button onclick="newData()">
        generate new data!
    </button>
    <br />
    <br />
    <button onclick="changeColor('red')">
        make 'em red!
    </button>
    <button onclick="changeColor('blue')">
        make 'em blue!
    </button>
    <button onclick="changeColor('green')">
        make 'em green!
    </button>
    <button onclick="colorScale(data)">
        data-driven colors!
    </button>
    
>>>>>>> d3-cookbook
</div>

<script type="text/javascript">
    function randomDataPoint() {
        var x = Math.round(Math.random() * 1000);
        var y = Math.round(Math.random() * 1000);
        var z = Math.round(Math.random() * 100);
        return [x,y,z];
    }

    function generateData(){
        var data = [];
<<<<<<< HEAD
        for(var i = 0; i < 10; i++){
=======
        for(var i = 0; i < numdatapoints; i++){
>>>>>>> d3-cookbook
             data.push(randomDataPoint());
        }
        return data;
    }

    var height = 500, 
        width = 500, 
        lmargin = 40,
        bmargin = 30,
        maxRad = 15,
        xaxisWidth = width - 2*lmargin,
        yaxisHeight = height - 2*bmargin,
<<<<<<< HEAD
        svg;
    
    function createSvg(){
        svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height);
    }
    
    function setup(){
        if(svg) svg.remove();
        
        createSvg();

        var xscale = d3.scale.linear()
=======
        numdatapoints = 20,
        svg,
        data,
        xscale,
        yscale,
        zscale;
      
    function setup(){
        if(svg) svg.remove();
        
        svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height);

        xscale = d3.scale.linear()
>>>>>>> d3-cookbook
                       .domain([0, 1000])
                       .range([lmargin, (xaxisWidth - 2*maxRad)]);
        
        var xaxis = d3.svg.axis() 
                      .scale(xscale) 
                      .orient('bottom')
                      .ticks(5);
        
        svg.append("g")
           .attr("class", "axis")
           .attr("transform", "translate(0," + (yaxisHeight-bmargin) + " )")
           .call(xaxis);

<<<<<<< HEAD
        var yscale = d3.scale.linear()
=======
        yscale = d3.scale.linear()
>>>>>>> d3-cookbook
                       .domain([0,1000])
                       .range([(yaxisHeight - 2*maxRad),bmargin]);

        var yaxis = d3.svg.axis() 
                      .scale(yscale) 
                      .orient('left')
                      .ticks(5);

        svg.append("g")
           .attr("class", "axis")
           .attr("transform", "translate(" + lmargin + ",0)")
           .call(yaxis);

<<<<<<< HEAD
        var zscale = d3.scale.linear()
                       .domain([0,100])
                       .range([3,maxRad]);

        var data = generateData();
=======
        zscale = d3.scale.linear()
                       .domain([0,100])
                       .range([3,maxRad]);

        data = generateData();
>>>>>>> d3-cookbook

        d3.select("body").select("svg").selectAll("circle")
            .data(data)
            .enter()
<<<<<<< HEAD
            .append("circle").classed("circle", true)
            .attr("cx", function(d) { return xscale(d[0]); })
            .attr("cy", function(d) { return yscale(d[1]); })
            .attr("r", function(d) { return zscale(d[2]); });

    }
  
=======
            .append("circle")
            .attr("cx", function(d) { return xscale(d[0]); })
            .attr("cy", function(d) { return yscale(d[1]); })
            .attr("r", function(d) { return zscale(d[2]); })
            .attr("fill-opacity",".7")
            .attr("fill", "black");
    }

    function newData(){
        data = generateData();

        svg.selectAll("circle")
           .data(data)
           .transition()
           .duration(1000)
           .attr("cx", function(d) { return xscale(d[0]); })
           .attr("cy", function(d) { return yscale(d[1]); })
           .attr("r", function(d) { return zscale(d[2]); })
    }

    function changeColor(color){

        var opacscale = d3.scale.linear()
                          .domain([0,100])
                          .range([0.9,0.3]);

        d3.select("body").select("svg").selectAll("circle")
            .data(data)
            .transition()
            .duration(1000)
            .attr("fill",color)
            .attr("fill-opacity",function(d) { return opacscale(d[2]); });
    }
  
    function colorScale(data){

        var xycol = d3.scale.linear().domain([0,1000]).range([0,255]); 
        var zcol  = d3.scale.linear().domain([0, 100]).range([0,255]);

        svg.selectAll("circle")
            .data(data)
            .transition()
            .duration(1000)
            .attr("fill-opacity",".8")
            .attr("fill", function(d) { return "rgb(" + Math.round(xycol(d[0])) + "," + Math.round(xycol(d[1])) + "," + Math.round(zcol(d[2])) + ")"; });
    }
>>>>>>> d3-cookbook
</script>

</body>

</html>